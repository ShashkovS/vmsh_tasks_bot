<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>–î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏—ë–º –∫—Ä—É–∂–∫–∞ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ –¥–ª—è 5-7 –∫–ª–∞—Å—Å–∞ 179-–π —à–∫–æ–ª—ã</title>
    <style>
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        @media (orientation: landscape) {
            .video {
                width: 27%;
                /*max-width: 20rem;*/
                height: 99%;
                overflow: hidden;
                border: none;
            }

            .board {
                width: 72%;
                /*min-width: calc(99.9vw - 20rem);*/
                height: 99%;
            }
        }
        @media (orientation: portrait) {
            .video {
                width: 100%;
                max-height: 23rem;
                height: 35vh;
                overflow: hidden;
                border: none;
            }

            .board {
                width: 100%;
                min-height: calc(99.9vh - 23rem);
                height: 64.9vh;
            }
        }
        /* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    padding-top: 50px; /* Location of the box */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    font-family: Arial, Helvetica, Garuda, sans-serif; line-height: 1.3;
    font-size: 200%;
}
.modal button {
    font-family: Arial, Helvetica, Garuda, sans-serif; line-height: 1.5;
    font-size: 100%;
    display: inline-block;
}
/* Modal Content */
.modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
#opponentName {
    position: absolute;
    background-color: rgba(255,255,255,0.5);
    font-size: 120%;
    padding-left: 1rem;
    display: none;
}
#problemButtons {
    position: absolute;
    bottom: 0;
    right: 0;
    background-color: rgba(255,255,255,0.5);
    font-size: 120%;
    padding-left: 1rem;
    display: block;
}
    </style>
<script>
    const url = new URL(window.location.href);
    // const room = [[room]];
    const room = 'hello';
    const boardUrl = `https://whitebophir.proj179.ru/boards/${room}`;

    function showOpponentName(name) {
        const op = document.getElementById('opponentName');
        op.innerText = name;
        op.style.display = "block";
    }

    function initVideoFrame(video=0, room='room') {
        const videoUrl = `https://brie.fi/ng/${room}?audio=1&video=${video}&fs=0&invite=0&prefs=1&share=0&chat=1`;
        const briefiFrame = document.createElement("iframe");
        briefiFrame.setAttribute("id", "briefiFrame");
        briefiFrame.setAttribute("src", videoUrl);
        briefiFrame.setAttribute("scrolling", "no");
        briefiFrame.setAttribute("align", "left");
        briefiFrame.setAttribute("allow", "camera; microphone; fullscreen; speaker; display-capture");
        briefiFrame.className = "video";
        briefiFrame.onmessage = ((e)=>console.log('!!!', e));
        document.body.appendChild(briefiFrame);
    }

    function initWhiteboardFrame() {
    // Now add whiteboard frame
        const wboFrame = document.createElement("iframe");
        wboFrame.setAttribute("id", "wboFrame");
        wboFrame.setAttribute("src", boardUrl);
        wboFrame.setAttribute("scrolling", "no");
        wboFrame.setAttribute("align", "right");
        wboFrame.className = "board";
        document.body.appendChild(wboFrame);
    }

    function setWhiteboardName(url) {
        console.log('setWhiteboardName');
        const wboFrame = document.getElementById("wboFrame");
        wboFrame.src = url;
    }

    window.addEventListener("message", (event) => {
        console.log('event from iframe', event);
    }, false);
    console.log('something changed');
    window.onmessage = (event) => {
        console.warn('event from iframe', event);
    };
    function showPopup(html, button1, buttonTitle1, buttonOnclick1, button2=undefined, buttonTitle2=undefined, buttonOnclick2=undefined) {
        const popup = document.getElementById("popup");
        const popupText = document.getElementById("popupText");
        const popupButton1 = document.getElementById("popupButton1");
        const popupButton2 = document.getElementById("popupButton2");
        popupText.innerHTML = html;
        popupButton1.innerText = button1;
        popupButton1.title = buttonTitle1;
        popupButton1.onclick = buttonOnclick1;
        if (button2 === undefined) {
            popupButton2.style.display = "none";
        } else {
            popupButton2.style.display = "inline-block";
            popupButton2.innerText = button2;
            popupButton2.onclick = buttonOnclick2;
            popupButton1.title = buttonTitle2;
        }
        popup.style.display = "block";
    }
    function hidePopup() {
        const popup = document.getElementById("popup");
        popup.style.display = "none";
    }
    function askIfVideoIsSuccessfull() {
        showPopup(`–ó–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –ª–∏ –≤–∏–¥–µ–æ?`,
                   'üëå –î–∞!', '–î–∞, —è –º–æ–≥—É –≤–∏–¥–µ—Ç—å —Å–µ–±—è!', ()=>intro(),
                   '‚ö† –ù–µ—Ç :(', '–ù–µ—Ç, —É –º–µ–Ω—è —á—ë—Ä–Ω–æ–µ –æ–∫–Ω–æ', ()=>tryToTurnOnMic());
    }
    function tryToTurnOnMic() {
        showPopup(`–í –±—Ä–∞—É–∑–µ—Ä–µ –≤ —Å—Ç—Ä–æ–∫–µ —Å –∞–¥—Ä–µ—Å–æ–º –ª–∏–±–æ —Å–ª–µ–≤–∞, –ª–∏–±–æ —Å–ø—Ä–∞–≤–∞ –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ—á—ë—Ä–∫–Ω—É—Ç–∞—è –∫–∞–º–µ—Ä–∞ –∏–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ.<br>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç—Ç—É –ø–∏–∫—Ç–æ–≥—Ä–∞–º–º—É –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É.<br>–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.`,
                   'üëå –ü–æ–ª—É—á–∏–ª–æ—Å—å!', '–î–∞, —è –º–æ–≥—É –≤–∏–¥–µ—Ç—å —Å–µ–±—è!', ()=>intro(),
                   '‚ö† –ù–µ—Ç, –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç :(', '–ù–µ—Ç, —É –º–µ–Ω—è —á—ë—Ä–Ω–æ–µ –æ–∫–Ω–æ', ()=>oopsGoOnZoom());
    }
    function intro() {
        initWhiteboardFrame();
        showPopup(`–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ —Å–¥–µ–ª–∞—Ç—å –ø–æ–º–µ—Ç–∫–∏ –∫ –∑–∞–¥–∞—á–∞–º (–≤—ã–±–∏—Ä–∞–π—Ç–µ –Ω—É–∂–Ω—É—é)`,
                   'üëå –ü–æ–µ—Ö–∞–ª–∏!', '–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å!', ()=>loadBoardAndCo());
    }
    function oopsGoOnZoom() {
        // TODO –•–ê–†–î–ö–û–î –ë–û–¢–ê!!!
        showPopup(`–ü–µ—á–∞–ª—å–Ω–æ. –¢–æ–≥–¥–∞ –æ–Ω-–ª–∞–π–Ω —Å—Ö–µ–º–∞ –¥–ª—è –≤–∞—Å —Ç–∞–∫–∞—è: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ zoom –∏ —Å—Ç–∞—Ä—Ç—É–µ—Ç–µ –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é.<br>–í –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –∑–µ–ª—ë–Ω—ã–π —â–∏—Ç. –ö–ª–∏–∫–∞–µ—Ç–µ –Ω–∞ –Ω–µ–≥–æ –∏ –∫–æ–ø–∏—Ä—É–µ—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à—É –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é.<br>–ó–∞–ø—É—Å–∫–∞–µ—Ç–µ –≤–º—à-—Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞ –∏ –ø–∏—à–µ—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å –≤–∞—à–µ–π —Å—Å—ã–ª–∫–æ–π –≤–∏–¥–∞ <br><code>/set_zoom https://us02web.zoom.us/j/123?pwd=ABC</code>`,
                   '–Ø—Å–Ω–æ, –∑–∞–ø—É—Å–∫–∞—é zoom –∏ –≤—Å—Ç–∞–≤–ª—è—é –Ω–æ–º–µ—Ä –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –≤ –±–æ—Ç–∞', '–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç–∞', ()=>window.location.href="https://t.me/vmsh179bot");
    }
    function loadBoardAndCo() {
        hidePopup();
        showOpponentName("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω qwery, 5–∫–ª, 8.2–ª–µ—Ç");
    }


    function audioAndVideoCheck() {
        hidePopup();
        initVideoFrame(1, 'room');
        setTimeout(()=>askIfVideoIsSuccessfull(), 3000);
    }
</script>
</head>
<body>
<div id="opponentName"></div>
<div id="popup" class="modal">
  <div class="modal-content">
    <p id="popupText"></p>
      <button id="popupButton1"></button>
      <button id="popupButton2"></button>
  </div>
</div>
<div id="problemButtons"></div>

<script>
    showPopup(`–î–ª—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø—Ä–∏—ë–º–∞ –Ω—É–∂–Ω—ã –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏ –∫–∞–º–µ—Ä–∞.
               <br>
               –°–µ–π—á–∞—Å –±—Ä–∞—É–∑–µ—Ä –ø–æ–ø—Ä–æ—Å–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∏ –∫–∞–º–µ—Ä–µ, –µ–≥–æ –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å.`,
               '–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–µ–æ—Å–≤—è–∑—å',
               `–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –º—ã –≤–∫–ª—é—á–∏–º –æ–∫–Ω–æ —Å –≤–∏–¥–µ–æ –∏ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∏ –∫–∞–º–µ—Ä–µ`,
        ()=>audioAndVideoCheck() );
</script>
</body>
</html>
